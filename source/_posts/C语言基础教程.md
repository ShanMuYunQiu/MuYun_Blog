---
title: C语言基础教程
author: 圣奇宝枣
description: 有关于C语言的基础教程，包括基本语法与基础的逻辑知识，比较适合新手上手
sticky: 1
date: 2022-05-09 08:21:06
updated: 2022-06-16 15:02:12
readmore: true
tags:
  - C语言
  - 基础语法
  - 教程分享
categories:
  - 编程语言
---

---

#### **初识 C 语言**

---

> **章节概要**：C 语言的特点、计算机工作原理、高级计算机语言、编译器、编程步骤、C 编程机制

##### **特点**

- **设计特性**：
  > C 语言融合了**计算机科学理论**和**实践的控制特性**  
  > C 语言的设计理念让用户轻松完成**自顶向下的规划**、**结构化编程**和**模块化设计**

<!-- more -->

- **高效性**：
  > C 语言充分利用计算机的优势，因此**程序更紧凑**，**运行速度很快**  
  > C 语言具有通常汇编语言才具有的微调控制能力，可以更具具体情况**微调程序**以获得**最大运行速度**或**最有效地使用内存**
- **可移植性**：
  > C 是可移植的语言，这意味着，在一种系统中编写的 C 程序**稍作修改**或**不修改**就能在其他系统上运行  
  > 注意程序中针对**特殊硬件设备**(如显示监视器)或**操作系统特殊功能**编写的部分**通常不可移植**  
  > C 语言与 UNIX 关系密切，**UNIX 系统**通常会将 C 编译器作为**软件包**的一部分  
  > 供个人计算机使用的 C 编译器很多，因此在**各个版本的操作系统**上，都可以找到合适的 C 编译器
- **强大而灵活**：
  > C 语言功能**强大而灵活**  
  > UNIX 操作系统、其他语言(FORTRAN、Perl、Python、Pascal)等的**编译器**和**解释器**都是**用 C 语言编写**的
- **面向程序员**：
  > C 语言是为了满足程序员的需求而设计的，程序员可以利用 C **访问硬件**、**操控内存中的位**  
  > 大多数 C 实现都有一个**大型的库**，包含众多有用的 **C 函数**，可以让程序员更加方便地使用 C 语言

##### **通俗了解计算机工作原理**

- 简而言之，计算机的**工作原理**是：如果希望计算机做某些事，就必须为其提供**特殊的指令列表**(**程序**)，确切地告诉计算机要做的事以及如何做。你必须用**计算机能直接明白的语言**(**机器语言**)创建程序。这是一项繁杂、乏味、费力的任务

##### **高级计算机语言与编译器**

- **高级编程语言**(如 C 语言)以多种方式**简化了编程工作**。首先，不必用数字码表示指令；其次，使用的指令更贴近你如何想这个问题，而不是类似计算机那样繁琐的步骤
- **编译器**是把**高级语言**程序**翻译**成计算机能理解的**机器语言**指令集的程序，在计算机看来，高级语言指令就是一堆无法理解的无用数据。由此，程序员进行高级思维活动，而编译器则负责处理冗长乏味的细节工作

##### **使用 C 语言的 7 个步骤**

- C 是**编译型语言**，我们把编写 C 语言的程序分解为七个步骤：
  > 1、定义程序的目标  
  > 2、设计程序  
  > 3、编写代码  
  > 4、编译  
  > 5、运行程序  
  > 6、测试与调试程序  
  > 7、维护和修改代码

##### **编程机制**

- 用 C 语言编写程序时，编写的内容被储存在文本文件中，该文件被称为**源代码文件**(**source code file**)。大部分 C 系统，都要求文件名以`.c`结尾
- C 编程的**基本策略**是，用程序把**源代码**文件**转换**成**可执行文件**(其中包含可直接运行的机器语言代码)  
  典型的 C 实现通过**编译**和**链接**两个步骤来完成这一过程。**编译器**把源代码转换成**中间代码**，**连接器**把中间代码和其他代码**合并**，生成可执行文件  
  ![](https://s2.loli.net/2022/05/22/ZyhE6a39RIPUOg4.png)

---

#### **C 语言概述**

---

> **章节概要**：C 语言程序简单示例、`#include`与头文件、主函数`main`、注释、花括号、声明与变量、赋值、`printf`函数、`return`语句、C 语言程序基础结构、多条声明、打印多个值、多个函数、关键字和保留标识符

##### **简单的 C 程序示例及分析**

```c
#include <stdio.h>

int main(void)                //一个简单的C程序
{
    int num;                  //定义一个名为num的变量
    num = 1;                  //为num赋一个值
    printf("I am a simple "); //使用printf函数
    printf("computer.\n");
    printf("my favourite number is %d because it is fitst.\n", num);
    return 0;
}
```

- **程序分析及知识概要**

  - `#include`指令和**头文件**
    > 1、`#include <stdio.h>`在程序的**第一行**，该语句作用相当于把`stdio.h`**文件**中的**所有内容**都**输入该行所在位置**，本质上是一种“**拷贝-粘贴**”的操作。`include`文件提供了一种方便的途径共享许多程序共有的信息  
    > 2、`#include`这行代码是一条 C**预处理器命令**，通常，C 编译器在编译前会对源码做一些**准备工作**，即**预处理**  
    > 3、所有的 C 编译器软件都提供`stdio.h`头文件，该文件包含供编译器使用的**IO 函数**(**I:input 输入，O:output 输出**)。该文件名含义为**标准输入/输出头文件**。通常，C 程序顶部的信息集合被称为**头文件**
  - `main()`函数
    > 1、`main()`函数是程序的**主函数**，它是程序的入口点，**从这里开始执行**  
    > 2、`int main()`中`int`是函数的**返回类型**，表明函数**返回操作系统**的是**整数**，此处将在后续探讨  
    > 3、如果浏览旧式的 C 代码，会发现程序如`main()`开始，C90 标准勉强接受这种形式，但 C99 和 C11 标准不允许，因此不要这样写  
    > 4、你还会看到`void main()`的形式，部分编译器允许这样写，但所有标准都未认可，因此也不要这样写
  - **注释**
    > 1、注释是一种**记录程序信息**的方式，**被注释的部分不会被程序运行**  
    > 2、可以使用`/*注释内容*/`进行注释，此类注释可以换行注释，直到`*/`为止  
    > 3、也可以使用`//`进行注释(C99 新加入)，此类注释不能换行，直到行尾为止
  - **花括号**
    > 1、程序中花括号`{}`把`main()`括起来，一般而言，所有的**C 函数**都**使用花括号标记**函数体的**开始和结束**  
    > 2、花括号还可用于把函数中**多条语句**合并为一个**单元**和**块**
  - **声明与变量**
    > 1、`int num;`这行代码叫做**声明**，声明是 C 语言中最重要的特性之一  
    > 2、该条例中，声明**完成了两件事**。其一，函数中**有一个**名为`num`的**变量**，其二，`int`表示`num`的**数据类型**是一个**整数**  
    > 3、`int`是 C 语言中的一个**关键字**，表示一种基本的 C 语言**数据类型**。关键字是**语言定义的单词**，不能用做其他用途，例如不可作为函数名或变量名  
    > 4、`num`是一个**标识符**，也就是一个**变量、函数或其他实体**的**名称**  
    > 5、把**变量**声明正确的为**数据类型**(整型、浮点型、字符等)，**计算机**才能正确的**存储、读取和解释数据**  
    > 6、变量的**命名**，要尽可能使用**有意义**的变量名或标识符，如程序需要一个变量属羊，则可起名**sheep_count**。变量命名时仅可以使用**大小写字母、数字和下划线**，且第一个字母不能是数字
  - **赋值**
    > 1、`num = 1`是**赋值表达式语句**，**赋值**是 C 语言的**基本操作**之一，意为“**把值 1 赋给变量**`num`”  
    > 2、在执行`int num`声明时，编译器在计算机**内存**中为变量`num`**预留了空间**，然后执行赋值表达式语句时，把值存储在**预留的位置**  
    > 3、注意，赋值表达式语句**从右侧把值赋给左侧**，另外，该语句以分号`;`结尾
  - `printf`函数
    > 1、`printf`是 C 语言的一个**标准函数**，圆括号`()`表明`printf`是一个**函数名**，**圆括号中的内容**是从`main()`函数**传递**给`printf`函数的信息  
    > 2、`printf`函数会查看**双引号中的内容**(**字符串**)，并将其**打印**到屏幕上  
    > 3、`\n`的作用是**换行**，`\n`组合代表一个**换行符**。换行符是一个**转义列表**，用于代表**难以表示**或**无法输入**的字符。如`\t`代表**Tab 键**，`\b`代表**Backspace 键**，每个转义序列都以**反斜杠**`\`开始  
    > 4、对比发现，参数中的`%d`被数字 1**代替**了，而 1 就是`num`的值。`%d`是一个**占位符**，其作用是**指明**输入`num`的**位置**
  - `return`语句
    > 1、`int main(void)`中的`int`表明函数`main`要**返回一个整数**，C 标准**要求**`main()`这样做。  
    > 2、**有返回值**的 C 函数要有`return`语句，该语句以`return`关键字**开始**，后面是**待返回的值**，并以分号`;`**结尾**  
    > 3、如果遗漏`main`函数末尾的`return`语句，程序在运行至最外面的`}`时，会自动**返回**一个**默认值**，**即 0**。因此此处**可以省略**，但在**其他**有返回值的函数中**不可省略**，所以**建议保留**此习惯

- **简单程序的结构**

  - 程序由**一个或多个函数**组成，**必须有**`main()`函数。
  - 函数由**函数头**和**函数体**组成，函数头包括**函数名**、**传入该函数的信息类型**和**函数的返回值类型**
  - 通过**函数名后**的**圆括号**可以识别出函数，圆括号里**可能为空**，**可能有参数**
  - **函数体**被**花括号**括起来，由一系列**语句**、**声明**组成

  ![](https://s2.loli.net/2022/05/22/Rm4WvcyqaZkgLuQ.png)

  - 简言之，一个简单的 C 语言程序格式如下(**大部分语句**都以**分号**`;`**结尾**)：

  ```c
  #include <stdio.h>
  int main(void)
  {
      //语句
      return 0;
  }
  ```

##### **进一步使用 C**

```c
//把2英寻转换成英尺
#include <stdio.h>
int main(void)
{
    int feet, fathoms;
    fathoms = 2;
    feet = 6 * fathoms;
    printf("There are %d feet in %d fathoms!\n", feet, fathoms);
    printf("Yes,I said %d feet!\n", 6 * fathoms);
    return 0;
}
```

- **程序分析及知识概要**
  - **多条声明**
    > 1、`int feet, fathoms;`语句，使用**多条声明**声明了**两个变量**，使用**逗号**`,`隔开，此语句与`int feet;`+`int fathoms;`等价
  - **打印多个值**
    > 1、程序的**第一个**`printf()`进行了**两次替换**，**按顺序**将`feet`、`fathoms`替换了两个`%d`  
    > 2、第二个`printf()`说明待打印的值**不一定是变量**，只要**可求值**得出**合适类型值的项**即可

##### **多个函数**

- 把**自己的函数**添加到程序中，此处只做简单了解，后续学习：

```c
#include <stdio.h>
void def(void)
{
    printf("hello world!");
}

int main(void)
{
    def();
    return 0;
}
```

##### **关键字和保留标识符**

- 下表中**粗体** 表示`C90`标准新增关键字，_斜体_ 表示`C99`标准新增关键字，**粗斜体** 表示`C11`标准新增关键字

  |  关键字   |  关键字  |    关键字    |        关键字         |
  | :-------: | :------: | :----------: | :-------------------: |
  |   auto    |  extern  |    short     |         while         |
  |   break   |  float   |  **signed**  |    **_\_Alignas_**    |
  |   case    |   for    |    sizeof    |    **_\_Alignof_**    |
  |   char    |   goto   |    static    |    **_\_Atomic_**     |
  | **const** |    if    |    struct    |     **_\_Bool_**      |
  | continue  | _inline_ |    switch    |    **_\_Complex_**    |
  |  default  |   int    |   typedef    |    **_\_Generic_**    |
  |    do     |   long   |    union     |   **_\_Imaginary_**   |
  |  double   | register |   unsigned   |   **_\_Noreturn_**    |
  |   else    | restrict |   **void**   | **_\_Static_assert_** |
  | **enum**  |  return  | **volatile** | **_\_Thread_local_**  |

---

#### **数据和 C**

---

> **章节概要**：交互式程序、变量与常量数据、数据、数据类型关键字、C 语言基本数据类型、进制打印显示(int 类型中)、可移植类型、使用程序获得数据类型大小

##### **示例程序(交互式程序引入)**

```c
#include <stdio.h>
int main(void)
{
    float weight;
    float value;
    printf("Please enter your weight in pounds:");
    scanf("%f", &weight);
    value = 1700.0 * weight * 14.5833;
    printf("your weight in platinum is worth $%.2f.\n", value);
    return 0;
}
```

- **新元素简单分析**
  - 新的**变量声明**，使用`float`**浮点数**类型，浮点类型可以**储存带小数的数字**，详细说明见本章后面部分
  - 为了打印**新类型**的变量(**浮点数**)，`printf`处使用`%f`**处理浮点值**了
  - `%.2f`用于**精确控制输出**，指定**保留小数**后两位
  - `scanf()`函数用于**读取键盘的输入**，`%f`说明`scanf()`**读取输入浮点数**，`&weight`告诉`scanf()`把输入的值**赋给**名为`weight`的**变量**
  - `scanf()`函数使用`&`**符号**表明找到`weight`变量的地点，下章将详细讨论，目前请按照这样写

##### **变量与常量数据**

- **变量**：有些**数据类型**在程序运行期间**可能会改变**或**被赋值**，这些称为**变量**
- **常量**：有些**数据类型**在程序使用之前已经**预先设定**好了，整个程序运行过程中**没有变化**，称为**常量**

##### **数据**

- **位、字节、字**

  > **位、字节、字**是描述**计算机数据单元**或**存储单元**的术语，这里主要指**储存单元**
  >
  > **位**(**bit**)：**最小的储存单元**。可以储存**0 或 1**，是计算机内存的**基本构成块**  
  > **字节**(**byte**)：**常用的**计算机存储单位，**字节**是**位**的**集合**，一个**字节**可以储存**8 位**。这是字节的**标准定义**，至少在衡量存储单位时是这样  
  > **字**(**word**)：是**设计计算机时**给定的**自然存储单位**，对于 8 位的微型计算机，一个字长只有 8 位。从那以后，个人计算机字节增至 16 位、32 位，直至目前的 64 位。计算机的**字长越大**，**数据转移越快**，允许的**内存访问也更多**

- **整数**

  - 和数学概念一样，**整数是没有小数部分的数**，例如 2、-23、2456 都是整数
  - 计算机以**二进制数字**存储整数，如整数 **7** 二进制写为 **111**，因此要在**8 位字节**中存储该数字，需要**前 5 位**设置为**0**，**后 3 位**设置为**1**

  ![](https://s2.loli.net/2022/05/22/lB6cG1hnKCqD8mY.png)

- **浮点数**

  - 与数学中**实数**概念差不多，例如 2.75、3.16E7、7.00、2e-8 都是浮点数
  - 注意，在一个值后面**加上小数点**，该值就成为一个**浮点数**，所以**7 是整数**，**7.00 是浮点数**
  - 此处简要介绍**e 计数法**(**科学计数法**)：**3.16E7**表示`3.16 * 10^7`
  - 这里关键要理解**浮点数**与**整数**的**储存方案不同**，计算机把浮点数分成**小数部分**和**指数部分**表示，而且**分开存储这两部分**。**7.0**写成**0.7E1**，这里，**0.7 是小数部分**，**1 是指数部分**。计算机在内部使用**二进制**和**2 的幂**进行储存，后续探讨(**此处图例以十进制下理解为例**)

  ![](https://s2.loli.net/2022/05/22/3JspxLR21l7TcDd.png)

##### **数据类型关键字**

| 最初 K&R 给出的关键字 | C90 标准添加的关键字 | C99 标准添加的关键字 |
| :-------------------: | :------------------: | :------------------: |
|          int          |        signed        |        \_Bool        |
|         long          |         void         |      \_Complex       |
|         short         |                      |     \_Imaginary      |
|       unsigned        |                      |                      |
|         char          |                      |                      |
|         float         |                      |                      |
|        double         |                      |                      |

##### **C 语言基本数据类型**

- `int`**类型**

  > 1、C 语言中的**整数类型**可表示**不同的取值范围**和**正负值**，一般情况下使用`int`能应付绝大多数情况  
  > 2、`int`类型是**有符号整型**，即`int`的值**必须是整数**，可以是正整数、负整数、0  
  > 3、`int`类型的**取值范围**因**计算机系统而异**，一般而言，储存一个`int`要**占用一个机器字长**  
  > 4、早期**16 位**的取值范围为`-2^15 ~ 2^15-1`，即`-32768 ~ 32767`，**ISO C 规定**`int`**最小范围**为`-32768 ~ 32767`  
  > 5、一般来说，系统会用一个**特殊位的值**(**未使用的第 16 位**)表示**有符号整数**的**正负号**  
  > 6、使用`%d`**打印**整数类型，`%d`称为**转换说明**，他**指定**应该用什么**格式**显示一个值  
  > 7、**显示不同进制**：使用`%d`显示十进制，`%o`显示八进制，`%x`显示十六进制。**显示前缀**使用`%#o`、`%#x`、`%#X`

  ```c
  #include <stdio.h>
  int main(void)
  {
      int x = 100;
      printf("dec=%d ; octal=%o ; hex=%x  \n", x, x, x);
      printf("dec=%#o ; octal=%#x ; hex=%#X", x, x, x);
      return 0;
  }
  ```

- **其他整数类型**

  > 1、`short`类型：占用空间可能比`int`少，有符号类型  
  > 2、`long`类型：占用空间可能比`int`多，有符号类型  
  > 3、`long long`类型(**C99 加入**)：占用空间可能比`long`多，**至少 64 位**，有符号类型  
  > 4、`unsigned`类型：**非负整型**，**16 位**取值范围`0 ~ 2^16-1`，即`0 ~ 65535`  
  > 5、**C90 后**，新增`unsigned short`、`unsigned long`；**C99 后**，新增`unsigned long long`  
  > 6、在任何**有符号类型前**添加关键字`signed`，可**强调**使用有符号类型的**意图**  
  > 7、空间“**可能**”多与少是因为 C**只规定**了`short`不能多于`int`，`long`不能少于`int`  
  > 8、现在**个人计算机**常见设置是，`long long`占**64 位**，`long`占**32 位**，`int`占**16 位**或**32 位**，`short`占**16 位**  
  > 9、打印时，使用`%u`打印`unsigned`类型，使用`%ld`打印`long`类型，使用`%lld`打印`long long`类型，使用`%hd`打印`short`类型

- **浮点数类型**

  > 1、**浮点类型**能表示**包括小数**在内更大范围的数，浮点数的表示类似**科学计数法**。在计算机中，科学计数法中的 10 的**指数**，跟写在字母`e`后面，如`1.02 * 10^3`记作`1.02e3`  
  > 2、**单精度浮点数**`float`，C 语言规定其至少能表示**6 位有效数字**，且取值范围至少是`10^-37 ~ 10^37`。通常，系统储存一个浮点数要**占用 32 位**，**其中 8 位**用于表示**指数的值和符号**，**剩下 24 位**用于表示**非指数部分及其符号**  
  > 3、**双精度浮点数**`double`，其与`float`类型的**最小取值范围相同**，但必须至少能表示**10 位有效数字**，一般来说，`double`**占用 64 位**而非 32 位。一些系统将多出来的 32 位**全用来**表示**非指数部分**，不仅增加**有效数字位数**(**即精度**)，还减少了**舍入误差**；另一些系统把**其中一些位**分配给**指数部分**，以容纳**更大的指数**，增加**可表示数的范围**。无论哪种类型，`double`类型的值**至少有 13 位有效数字**  
  > 4、`long double`，可以满足比`double`更高的精度要求，不过，C 只保证`long double`类型至少与`double`类型的**精度相同**  
  > 5、浮点数后面加上`f`**或**`F`**后缀**可**覆盖默认设置**，编译器会将**浮点型常量**看做`float`类型，如**2.3f**，**9.11E9F**；使用`l`**或**`L`**后缀**使数字成为`long double`类型；没有后缀的浮点型常量是`double`类型  
  > 6、**打印浮点值**时，使用`%f`打印`float`类型，用`%e`打印**指数计数法**的浮点值，如果系统支持十六进制的浮点数，使用`%a`打印**十六进制**的浮点值，打印`double`或`long double`要使用`%Lf`、`%Le`和`%La`的转换说明

- `char`**字符类型**

  > 1、`char`类型用来**储存字符**，如**字母**或**标点符号**  
  > 2、从技术层面来看，`char`是**整数类型**，因为`char`类型**实际储存**的是**整数**而不是字符。计算机使用**数字编码**来**处理字符**，即用特定**整数**代表特定**字符**  
  > 3、C 常用编码为**ASCII**编码，其中如**整数 65**代表**大写字母 A**，**整数 97**代表**小写字母 a**，**整数 48**代表**数字 0**  
  > 4、标准**ASCII 码**范围为**0~127**，只需 7 位二进制数即可表示。通常，`char`被定义为**8 位的存储单元**  
  > 5、C 语言把**1 字节**定义为`char`类型占用的**位**(**bit**)**数**  
  > 6、`char`赋值时，需要传入**char 字符类型**的数据，即**单引号**`''`包裹的字符，如`char set = 'A'`。此外也可使用**ASCII 码**进行赋值，如`char set = 65`  
  > 7、有一些**代表行为**的**非打印字符**，如换行、退格、回车、蜂鸣等，这些字符**打印不出来**。如需要表示这些字符，可以使用**ASCII 码**，比如蜂鸣：`char beep = 7`。此外也可以使用**转义字符**，如`char beep = '\a'`  
  > 8、使用`%c`**打印**`char`类型字符，如果使用`%d`**打印**，则会打印**字符对应 ACSII 码的整数**

  | 转义序列 | 含义                                                                   |
  | :------: | ---------------------------------------------------------------------- |
  |    \a    | 警报(ANSI C)                                                           |
  |    \b    | 退格                                                                   |
  |    \f    | 换页                                                                   |
  |    \n    | 换行                                                                   |
  |    \r    | 回车                                                                   |
  |    \t    | 水平制表符                                                             |
  |    \v    | 垂直制表符                                                             |
  |   \\\    | 反斜杠(\)                                                              |
  |   \\'    | 单引号(')                                                              |
  |   \0oo   | 八进制值(`oo`必须是有效的八进制数，即每个`o`可表示`0~7`中的一个数)     |
  |   \xhh   | 十六进制值(`hh`必须是有效的十六进制数，即每个`h`可表示`0~f`中的一个数) |

- `_Bool`**布尔类型**

  > 1、**C99**标准新增了`_Bool`类型，用于表示**布尔值**，即逻辑值**true**和**false**  
  > 2、因为 C 语言用**值 1**表示**true**，**值 0**表示**false**，所以`_Bool`类型实质上也是一种**整数类型**  
  > 3、原则上它仅占用**1 位存储空间**，因为对与**0 和 1**而言，一位的存储空间足够了

- **可移植类型：**`stdint.h`**和**`inttypes.h`

  > 1、**C99**新增两个**头文件**`stdint.h`和`inttypes.h`，以确保 C 语言**各类型**在**各系统**中**功能正常**  
  > 2、C 语言为**现有类型**创建了**更多类型名**，这些新类型名**被定义在**`stdint.h`中  
  > 3、如在**精确宽度整数类型中**，`int32_t`**表示 32 位的有符号整数类型**。在使用**32 位系统**时，头文件会把`int32_t`当做`int`的**别名**；而在`int`为**16 位**，`long`为**32 位**的系统中，系统会把`int32_t`当做`long`的别名。然后，使用`int32_t`类型**编写程序并包含**`stdint.h`**头文件**时，**编译器**会把`int`或`long`**替换**成与**当前系统匹配**的类型  
  > 4、如果系统**不支持精确宽度整数类型**，可以使用**最小宽度类型**，例如`int_least8_t`是**可容纳 8 位有符号整数值**的类型中**宽度最小**的类型的一个**别名**  
  > 5、如果更关心**速度**而非空间，则可使用**最快最小宽度类型**，如`int_fast8_t`被定义为**系统中**对**8 位有符号值**而言**运算最快的整数类型**  
  > 6、如果需要**最大整数类型**，最大的有符号整数类型`intmax_t`**可储存任何有效的有符号整数值**。类似的，`uintmax_t`表示最大的无符号整数类型，这种类型可能比`long long`和`unsigned long long`**更大**  
  > 7、C 标准针对这种**输入和输出**，提供了一些**字符串宏**来显示可移植类型，例如`inttypes.h`中定义了`PRId32`**字符串宏**，代表打印**32 位有符号值**的**合适转换说明**(**如 d 或 l**)

  ```c
  #include <stdio.h>
  #include <inttypes.h>
  int main(void)
  {
      int32_t me32;
      me32 = 45933945;
      printf("me32 = %" PRId32 "\n", me32);
      return 0;
  }
  ```

- **复数和虚数**

  > 1、许多**科学**和**工程计算**都要用到**复数和虚数**，**C99**支持复数和虚数，但是**有所保留**  
  > 2、**复数类型**：有`float_Complex`、`double_Complex`和`long double_Complex`。例如`float_Complex`变量应包含**两个**`float`**类型的值**，分别表示复数的**实部和虚部**  
  > 3、**虚数类型**：有`float_Imaginary`、`double_Imaginary`和`long double_Imaginary`  
  > 4、如果包含`complex.h`头文件，便可用`complex`代替`_Complex`，用`imaginary`代替`_Imaginary`，还可以用 1 代替-1 的平方根

- **其他类型**

  > 1、C 语言中**没有字符串类型**，却也能很好的处理字符串，详见后续  
  > 2、C 语言还有一些**基本类型衍生**的其他类型，如数组、指针、结构、联合，详见后续  
  > 3、本章程序案例简单使用到了**指针**，如`scanf()`函数用到的`&`前缀，便创建了一个指针，告诉`scanf()`把数据放在何处

##### **获取类型大小**

- 可以使用`sizeof()`获取以**字节**为单位的**类型大小**，**C99**和**C11**提供`%zd`匹配`sizeof()`返回值，其余不支持的编译器可用`%u`或`%lu`代替

```c
#include <stdio.h>
int main(void)
{
    printf("Type int has a size of %zd bytes.\n", sizeof(int));
    printf("Type char has a size of %zd bytes.\n", sizeof(char));
    printf("Type float has a size of %zd bytes.\n", sizeof(float));
    return 0;
}
```

---

#### **字符串和格式化输入输出**

---

> **章节概要**：字符串简介、char 类型数组与 null 字符、`strlen()`函数、常量与 C 预处理器、明示常量、`printf()`函数、参数传递、`scanf()`函数、`scanf`多个输入与返回值

##### **示例程序**

```c
#include <stdio.h>
#include <string.h>
#define DENSITY 62.4 // 定义人体密度
int main(void)
{
    float weight, volume;
    int size, letters;
    char name[40];
    printf("Hi! What's your first name?\n");
    scanf("%s", name);
    printf("%s,whats's your weight in pounds?\n", name);
    scanf("%f", &weight);
    size = sizeof(name);
    letters = strlen(name);
    volume = weight / DENSITY;
    printf("well, %s, your volume is %2.2f cubic feet\n", name, volume);
    printf("Also, your first name has %d letters,\n", letters);
    printf("and we have %d bytes to store it.\n", size);
    return 0;
}
```

- **新元素简单分析**

  - 用**数组**储存**字符串**。在该程序中，用户**输入的名**被储存在**数组**中，该数组占用内存中**40 个连续的字节**，每个字节储存一个字符值
  - 使用`%s`**转换说明**来**处理字符串**的输入和输出。注意，在`scanf`中，`name`**没有**`&`**前缀**，而`weight`有(稍后解释，`&weight`和`name`都是**地址**)
  - 用 C**预处理器**把**字符常量**`DENSITY`定义为 62.4
  - 用 C 函数`strlen()`获取字符串的长度

##### **字符串简介**

> 1、**字符串**是**一个或多个字符**的**序列**，如`"I came from America"`  
> 2、**双引号**`"`不是字符串的一部分，仅是**告知编译器**它**括起来的是字符串**，就如**单引号**`'`用于标识单个字符一样

##### **char 类型数组与 null 字符**

> 1、C 语言**没有**专门用于**存储字符串**的变量类型，字符都被储存在`char`**类型数组**中。**数组**由**连续的存储单元**组成，字符串的**字符**被储存在**相邻的存储单元**中，每个单元储存一个字符  
> 2、数组**末尾位置**有一个**空字符**(**\0**)，C 语言用**空字符**(**null**)标记**字符串结束**。这意味着**数组容量**必须**比存储字符数多 1**  
> 3、**数组**是**同类型数据元素**的**有序序列**，**方括号**`[]`表示这是一个数组  
> 4、使用`%s`来转换**打印**一个**字符串**  
> 5、**字符串**与**字符**`char`不是同一种类型，因为**字符串**最后有**空字符标识**，而`char`**只存储该字符**  
> 6、使用`strlen()`函数可以得到**字符串的字符长度**，且`strlen()`并**不会计入空字符**

##### **常量与 C 预处理器**

- **为什么要使用常量**

  > 1、使用常量名比数字**表达的信息更多**，如`area = PI * d`与`area = 3.14 * d`相比**更加直观**  
  > 2、对于程序中**多次使用同一个常量时**，如果常量的值需要**修改**，**只需要修改常量值**即可

- **如何创建符号常量**

  - 可以**定义变量**，将**其值**定义为**所需的值**，但这样程序可能会**无意间改变它的值**
  - 使用**C 预处理器**定义，格式为`#define 常量名 值`，**编译程序时**，所有的**常量名**都会**被替换**为它们的值
    - 定义常量时，**习惯上**建议**全用大写**，以此**告知他人**这是一个常量，提高程序可读性；此外也有**小众习惯**使用`c_变量名`或`k_变量名`表示常量
    - **注意**：`define`常量名后的内容用于替换符号常量，不要将`#define NUM 20`写成`#define NUM = 20`，这样定义的**WORD**值为`=20`而非`20`
  - **C90**标准新增限定词`const`，表示**只读**，也可用此**作为**常量使用(其只表明**只读变量**)，如`const float PI=3.14`

- **明示常量**

  - C 头文件`limits.h`与`float.h`分别提供与**整数与浮点数**类型**大小限制**相关的说明，如`limits.h`中有类似以下代码：
    ```c
    #define INT_MAX +32767
    #define INT_MIN -32768
    ```
  - 这些**明示常量**代表`int`类型可表示的**最大值和最小值**，**该头文件**会为这些明示常量提供**不同的值**，如果系统使用**32 位的 int**且程序包含`limits.h`头文件，则可以使用`printf()`与`%d`转换输出**该常量 32 位 int 的值**
  - 如果系统使用**4 字节的 int**，**该头文件**将提供**符合 4 字节的对应值**
  - 下为`limits.h`中的一些明示常量：

    |  明示常量  | 含义                            |
    | :--------: | ------------------------------- |
    |  CHAR_BIT  | char 类型的位数                 |
    |  CHAR_MAX  | char 类型的最大值               |
    |  CHAR_MIN  | char 类型的最小值               |
    | SCHAR_MAX  | signed char 类型最大值          |
    | SCHAR_MIN  | signed char 类型最小值          |
    | UCHAR_MAX  | unsigned char 类型的最大值      |
    |  SHRT_MAX  | short 类型的最大值              |
    | USHRT_MAX  | unsigned short 类型的最大值     |
    |  INT_MAX   | int 类型的最大值                |
    |  UINT_MAX  | unsigned int 类型的最大值       |
    |  LONG_MAX  | long 类型的最大值               |
    | ULONG_MAX  | unsigned long 类型的最大值      |
    | LLONG_MAX  | long long 类型的最大值          |
    | ULLONG_MAX | unsigned long long 类型的最大值 |

  - 相似的，`float.h`头文件下也有一些明示常量：

    |    明示常量    | 含义                                                |
    | :------------: | --------------------------------------------------- |
    |  FLT_MANT_DIG  | float 类型的尾数位数                                |
    |    FLT_DIG     | float 类型的最小有效数字位数(十进制)                |
    | FLT_MIN_10_EXP | 带全部有效数字的 float 类型的最小负指数(以 10 为底) |
    | FLT_MAX_10_EXP | float 类型的最大正指数(以 10 为底)                  |
    |    FLT_MIN     | 保留全部精度的 float 类型最小正数                   |
    |    FLT_MAX     | float 类型的最大正数                                |
    |  FLT_EPSILON   | 1.00 和比 1.00 大的最小 float 类型值之间的差值      |

##### **printf()函数**

- 请求`printf()`打印数据的**指令**要与待打印**数据类型**相匹配。例如，**打印整数**使用`%d`，**打印字符**使用`%c`。这些符号称为**转换说明**，它们指定如何把数据转换成**可显示的形式**。

- **ANSI C**标准为`printf()`提供的**转换说明**

  | 转换说明 | 输出                                                                    |
  | :------: | ----------------------------------------------------------------------- |
  |    %a    | 浮点数、十六进制数和 p 计数法                                           |
  |    %A    | 浮点数、十六进制数和 p 计数法                                           |
  |    %c    | 单个字符                                                                |
  |    %d    | 有符号十进制整数                                                        |
  |    %e    | 浮点数，e 计数法                                                        |
  |    %E    | 浮点数，e 计数法                                                        |
  |    %f    | 浮点数，十进制计数法                                                    |
  |    %g    | 根据值的不同，自动选择%f 或%e。%e 格式用于指数小于-4 或者大于等于精度时 |
  |    %G    | 根据值的不同，自动选择%f 或%E。%E 格式用于指数小于-4 或者大于等于精度时 |
  |    %i    | 有符号十进制整数(与%d 相同)                                             |
  |    %o    | 无符号八进制整数                                                        |
  |    %p    | 指针                                                                    |
  |    %s    | 字符串                                                                  |
  |    %u    | 无符号十进制整数                                                        |
  |    %x    | 无符号十六进制整数，使用十六进制数 0f                                   |
  |    %X    | 无符号十六进制整数，使用十六进制数 0F                                   |
  |    %%    | 打印一个百分号                                                          |

- `prinft()`的转换说明**修饰符**，在`%`与**转换字符**之间插入**修饰符**可修饰基本转换说明

  | 修饰符 | 含义                                                                                                                                                                                                                                                                                                                                  |
  | :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
  |  标记  | 本表格下一张表格描述了 5 种标记(-、+、空格、#、0)，可以不使用标记或使用多个标记，如`%-10d`                                                                                                                                                                                                                                            |
  |  数字  | 最小字段宽度，如果该字段不能容纳待打印内容则会使用更宽的字段，如`%4d`                                                                                                                                                                                                                                                                 |
  | .数字  | 精度。对于`%e`和`%f`转换，表示小数点右边数字位数 ； 对于`%g`转换，表示有效数字的最大位数 ； 对于`%s`转换，表示待打印字符最大数量 ； 对于**整型**转换，表示待打印数字的最小位数。如有必要，使用前导 0 达到这个位数，只使用`.`表示其后跟随一个 0，所以`%.f`与`%.0f`相同。如`%5.2f`表示打印一个字段宽度为 5，小数点后有 2 位数字的浮点数 |
  |   h    | 和整型转换说明一起使用，表示 short int 或 unsigned short int 类型的值，如`%hu`、`%hx`、`%6.4hd`                                                                                                                                                                                                                                       |
  |   hh   | 和整型转换说明一起使用，表示 signed char 或 unsigned char 类型的值，如`%hhu`、`%hhx`、`%6.4hhd`                                                                                                                                                                                                                                       |
  |   j    | 和整型转换说明一起使用，表示 intmax_t 或 uintmax_t 的值，这些类型定义在`stdint.h`中                                                                                                                                                                                                                                                   |
  |   l    | 和整型转换说明一起使用，表示 long int 或 unsigned long int 类型的值                                                                                                                                                                                                                                                                   |
  |   ll   | 和整型转换说明一起使用，表示 long long int 或 unsigned long long int 类型的值                                                                                                                                                                                                                                                         |
  |   L    | 和浮点转换说明一起使用，表示 long double 的值                                                                                                                                                                                                                                                                                         |
  |   t    | 和整型转换说明一起使用，表示 ptrdiff_t 类型的值，ptrdiff_t 是两个指针差值的类型(C99)                                                                                                                                                                                                                                                  |
  |   z    | 和整型转换说明一起使用，表示 size_t 类型的值，size_t 是 sizeof 返回的类型(C99)                                                                                                                                                                                                                                                        |

  - 注：`%u`标记**不能把数字和符号分开**，会报错!!

- `printf()`中的**标记**

  | 标记 | 含义                                                                                                                                                                                                     |
  | :--: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
  |  -   | 待打印项左对齐，即从字段左侧开始打印该项，如`%-20s`                                                                                                                                                      |
  |  +   | 有符号值若为正，则在值前面显示加号(正号)，若为负则显示减号(负号)，如`%+6.2f`                                                                                                                             |
  | 空格 | 有符号值若为正，则在值前面显示前导空格(不显示任何符号)，若为负则显示减号(负号)覆盖前导空格，如`% 6.2f`                                                                                                   |
  |  #   | 把结果转换成另一种形式。如果是`%o`格式，则从 0 开始 ； 如果是`%x`格式，则从 0x 开始 ； 如果是**浮点**格式，`#`则保证了即使后面没有任何数字也打印一个小数点 ； 如果是`%g`格式，`#`防止结果后面的 0 被删除 |
  |  0   | 对于数值格式，使用前导 0 代替空格填充字段宽度 ； 对于整数格式，如果出现-标记或指定精度，则忽略该标记                                                                                                     |

##### **参数传递**

- **参数传递机制**因实现而异，下面以**本机系统**中的**本程序**分析参数传递。该调用告诉计算机把**变量 n1、n2、n3、n4**的值传递给程序，是一种**常见的传参方式**

  ```c
  #include <stdio.h>
  int main(void)
  {
      float n1 = 3.0;
      double n2 = 3.0;
      long n3 = 2000000000;
      long n4 = 1234567890;
      printf("%ld  %ld  %ld  %ld", n1, n2, n3, n4);
      return 0;
  }
  ```

  > 1、程序把**传入的值**放入被称为**栈**的**内存区域**，计算机根据**变量类型**(**不是转换说明**)把值放入**栈**中。  
  > 2、因此，**n1**被储存在**栈**中，**占 8 字节**(**float 被转换成 double 类型**)。同样，**n2**在**栈**中也占**8 字节**，而**n3、n4**分别占**4 字节**  
  > 3、然后，控制转到`printf()`，其根据**转换说明**从**栈**中读取值。`%ld`转换说明表明**应读取 4 字节**，所以`printf()`读取**前 4 字节**作为**第 1 个值**。这是**n1 前半部分**，将被解释成**long 类型整数**，根据下一个转换说明，`printf()`**再读取 4 字节**，这是**n1 后半部分**，将被解释为**第 2 个 long 类型整数**  
  > 4、类似的，继续读取**第 3、4 个**`%ld`，读取为**n2 的前、后半部分**，并解释成**两个 long 类型整数**  
  > 5、因此，对于**n3、n4**虽然用对了转换说明，但还是**读错了字节**

  ![](https://s2.loli.net/2022/05/25/jvdeNSciuAJbRaY.png)

##### **scanf()函数**

- `scanf()`是最通用的**输入函数**，因为它可以读取**不同格式的数据**，其将输入的**字符串**转换成**整数**、**浮点数**、**字符**或**字符串**

- `scanf()`使用**指向变量的指针**，而`printf()`使用**变量、常量、表达式**

- `scanf()`的**多个输入**

  > 1、可以通过`scanf("%d%d",&n,&m)`的格式**输入多个数据**  
  > 2、`scanf()`函数允许把**普通字符**放在**格式字符串**中，**除空格外**的字符必须与输入字符串**严格匹配**  
  > 3、如`scanf("%d,%d",&n,&m)`，用户必须输入**两个整数**，并以**逗号分隔**  
  > 4、除了`%c`，其他转换说明都会**自动跳过待输入值前面的所有空白**

- `scanf()`的**返回值**

  > `scanf()`函数返回**成功读取的项数**  
  > 如果**没有成功读取**任何项，且需要读取**一个数字**而用户输入一个**数值字符串**，其便返回**0**  
  > 当`scanf()`检测到“**文件结尾**”时，会返回**EOF**。这是`stdio.h`中定义的特殊值，通常会用`#define`将其定义为-1

- **ANSI C**标准为`scanf()`准备的**转换说明**和转换说明**修饰符**

  - `scanf`的**转换说明**与**修饰符**与`printf`的基本一致，但过程上从**转换输出**变成了**解释输入**，具体使用方法参考`printf`的表格

---

#### **运算符、表达式和语句**

---

> **章节概要**：`while`循环简述、运算符、赋值术语、`sizeof`运算符和`size_t`类型、表达式、语句和块、语句术语、类型转换、强制类型转换、带参数的函数、形参实参

##### **while 循环简述**

- **示例程序**

  ```c
  #include <stdio.h>
  #define ADJUST 6.37
  int main(void)
  {
      const double SCALE = 0.333;
      double shoe, foot;
      printf("Shoe size (men's)   foot length\n");
      shoe = 3.0;
      while (shoe < 10.5)
      {
          foot = SCALE * shoe + ADJUST;
          printf("%10.1f %15.2f inches\n", shoe, foot);
          shoe = shoe +1;
      }
      printf("If the shoe fits , wear it.\n");
      return 0;
  }
  ```

- **while 循环**

  > 1、当**条件语句**为**真**时，执行**循环体**。**圆括号**内为**关系表达式**，**花括号**内为**循环体**  
  > 2、该程序中，程序判断`shoe < 18.5`**是否为真**，执行**循环体**内的代码，到达**花括号**时**再次判断表达式**，为**真**则**继续执行**，当**条件语句**为**假**时，**结束循环**

##### **运算符**

- **赋值运算符: =**

  > 1、C 语言中，**等号**`=`意为**赋值**而非**相等**。**赋值运算符**将**右侧的值赋给左侧**  
  > 2、当**赋值运算符**连用时，如`a=b=c=10`，仍按照**从右向左**方式**链式赋值**，即`c=10`，`b=c`，`a=b`

  - **几个术语：数据对象、左值、右值、项**

    > **数据对象**：赋值表达式语句的目的是把**值**储存到**内存位置**上，用于储存**值**的**数据存储区域**统称为**数据对象**  
    > **左值**：是 C 语言的术语，用于标识**特定数据对象**的**名称**或**表达式**。因此，**对象**指的是**实际的数据储存**，而**左值**是用于**标识**或**定位**储存**位置**的**标签**  
    > **右值**：指的是**赋值**给**可修改左值**的**量**，且**本身不是左值**  
    > **项**：学习名称时，被称为**项**的就是**运算对象**(如，赋值运算符左侧的项)。**运算对象**是**运算符**操作的对象

- **基本算术运算符**

  > 1、**加法运算符**`+`、**减法运算符**`-`、**乘法运算符**`*`、**除法运算符**`/`  
  > 2、**加和减**都被称为**二元运算符**  
  > 3、C 语言中的**除法**，若变量类型为**整数**，则除法的**商**的**小数部分**会**被舍弃**

- **符号运算符: +和-**

  > 1、`+`**和**`-`还可以做**符号运算符**，用作**正负号**  
  > 2、用作**正负号**时，为**一元运算符**

- **取模(余)运算符**

  > 1、用于**整数运算**，得到相除的**余数**，如`9 % 2 = 1`  
  > 2、**负数求模**，**C99**后，若**第一个运算对象**为**负数**，那么取模的结果为**负数**，反之亦然。如`11 % -5 = 1`，`-11 % 5 = -1`，`-11 % -5 = -1`

- **递增/减运算符: ++和--**

  > 1、下文以`++`为例  
  > 2、两种形式：`++`出现在**变量前**，为**前缀模式**；`++`出现在**变量后**，为**后缀模式**  
  > 3、该**运算符作用**为变量**自加一**，如`a++`意为`a = a + 1`  
  > 4、当**单独使用**递增运算符时，使用哪种形式都没关系  
  > 5、当使用**较为复杂**时，**则会不同**。如`q = 2*++a;`，意为**a 递增 1，后 2\*a，再将结果赋给 q**；而`q = 2*a++;`，意为**2\*a，后将结果赋给 q，再 a 递增 1**  
  > 6、由于**前后缀模式**的以上特性会对代码**产生不同的影响**，因此最好**单独使用**(如需复合使用时，可以先单独自增再使用)

- **sizeof 运算符和 size_t 类型**

  > 1、第 3 章已介绍，`sizeof`运算符用于以**字节**为单位返回**运算对象的大小**  
  > 2、C 语言规定，`sizeof`返回`size_t`类型数值，这是一个**无符号整数类型**，其为**语言定义**的**标准类型**  
  > 3、**C99**后使用`%zd`用于转换显示`size_t`类型，如不支持可以使用`%u`或`%lu`代替

##### **表达式、语句和块**

- **表达式**

  > 1、**表达式**由**运算符**和**运算对象**组成。**最简单的表达式**是**单个运算对象**，以此为基础可以建立**复杂的表达式**  
  > 2、**运算对象**可以是**常量**、**变量**或**二者的组合**  
  > 3、每个表达式**都有一个值**，如`q=5*2`作为一个整体的**值为 10**；表达式`q>3`的值为**布尔值**，为**true**或**false**，即值为 1 或 0

- **语句**

  > 1、**语句**是 C 程序的**基本构建块**，**一条语句**相当于**一条完整的计算机指令**，C 中大部分语句都以**分号**`;`**结尾**  
  > 2、最简单的语句为**空语句**，只有一个分号构成；C 把**末尾加上一个分号**的**表达式**也**看做语句**，因此`8;`，`3+4;`这些语句也没问题，只是在程序中**什么都不做**

  - **副作用、序列点、完整表达式**

    > 1、**副作用**：副作用是对**数据对象**或**文件**的**修改**。例如语句`states=50;`，其**副作用**为**修改**变量 states 的值为 50。这似乎是**主要目的**，而在**C 语言的角度**看，**主要目的**是**对表达式求值**，如**表达式**`4+6`求值得`10`，给出**表达式**`states=50`求值得`50`  
    > 2、**序列点**：是**程序执行**的点，在该点上，**所有的副作用**都在**进入下一步之前**发生。**语句**中的**分号**标记了一个序列点，另外，任何**完整表达式**的结束也是一个序列点  
    > 3、**完整表达式**：指这个表达式**不是**另一个**更大表达式**的**子表达式**

- **复合语句(块)**

  > **复合语句**：是用**花括号**括起来的**一条或多条语句**，**复合语句**也称为**块**

##### **类型转换**

- 通常，在**语句**和**表达式**中，应使用**类型相同**的变量和常量。但是，如果使用**混合类型**，C 会采用一套规则进行**自动类型转换**，虽然这很便利，但有一定危险性，尤其是在无意间混合使用类型的情况下

- **基本的类型转换规则**

  > 1、当类型转换出现在**表达式**时，无论是`unsigned`还是`signed`的`char`和`short`都会被自动转换成`int`，如有必要会被自动转换成`unsigned int`(如果`short`和`int`**大小相同**，`unsigned short`就比`int`大，此时`unsigned short`会被转换成`unsigned int`)。由于都是**较小类型**转换为**较大类型**，所以这些转换被称为**升级**  
  > 2、涉及**两种类型**的**运算**，两个值会被**分别转换**成两种类型的**更高级别**  
  > 3、类型的**级别从高至低**依次是：`long double`、`double`、`float`、`unsigned long long`、`long long`、`unsigned long`、`long`、`unsigned int` 、`int`。**例外**的情况是，当`long`和`int`**大小相同时**，`unsigned int`级别比`long`的级别高。之所以`short`和`char`没有列出，是因为它们已经**被升级**成了`int`或`unsigned int`  
  > 4、在**赋值表达式语句**中，计算的**最终结果**会被转换成**被赋值变量**的类型，因此该过程可能导致类型**升级或降级**  
  > 5、当作为**函数参数传递**时，`char`和`short`被转换成`int`，`float`被转换成`double`。第九章将介绍，函数原型会覆盖自动升级

- **强制类型转换**

  - 通常，应该避免**自动类型转换**，尤其是**类型降级**，但如果能小心使用，类型转换也很方便
  - 当需要进行**精确的类型转换**，或者在程序中**表明类型转换的意图**，此时要用到**强制类型转换**
  - **强制类型转换**:在某个量**前面**放置用**圆括号**`()`括起来的**类型名**，该**类型名**即是希望转换成的**目标类型**。**圆括号**和它括起来的**类型名**构成了**强制类型转换运算符**，其通用形式为`(type)`，例子为`score = (int)1.6 + (int)1.7`

##### **带参数的函数**

- **示例程序**

  ```c
  #include <stdio.h>
  void pound(int n)           // 定义函数
  {
      while (n-- > 0)
      {
          printf("#");
      }
      printf("\n");
  }

  int main(void)
  {
      int times = 5;
      char ch = '!';
      float f = 6.0;
      pound(times);
      pound(ch);
      pound(f);
      return 0;
  }
  ```

- **参数-形参、实参**

  - 首先，看**函数头**`void pound(int n)`，如果函数**不接受任何参数**，那么**圆括号中**应写上`void`。由于该函数接受一个`int`类型的**参数**，所以其中包含一个`int`类型的**变量 n**的声明。参数名应遵循 C 语言的**命名规则**
  - 声明参数就创建了被称为**形式参数**的**变量**(简称**形参**)，该例中，形式参数是 int 类型的**变量 n**；像`pound(10)`这样的**函数调用**会把 **10** 赋给 **n** ，我们称函数调用**传递的值**为**实际参数**(简称**实参**)
  - 函数调用`pound(10)`把**实参 10**传递给**函数**，函数将 **10** 赋给**形参**
  - **变量名**是函数**私有的**，即在**函数中定义**的变量名**不会**和**别处的相同名称**发生冲突

- **函数调用**

  - 现在，来学习**函数调用**，如第一次调用`pound(times)`，**times**的值**5**被赋给**n**，因此函数打印了**5 个井号和一个换行符**
  - 第二次调用`pound(ch)`，此时**ch**是`char`类型变量，被初始化为`!`，其**ASCII 码**为**33**。由于函数形参类型为`int`，与`char`不匹配，所以程序开头的**函数原型**发挥了作用；**原型**即**函数声明**，描述函数**返回值**和**参数**，`pound`原型说明了两点：
    > 1、函数**没有返回值**(**函数名**前关键字为`void`)  
    > 2、函数有一个`int`类型的**形参**
  - 函数原型告诉编译器，函数**接受一个**`int`类型的**参数**，当编译器执行到`pound(n)`时，参数**ch**被自动转换成`int`类型，于是从**1 字节的 33**变成了**4 字节的 33**。于此类型，第三次调用`pound(f)`也使得`float`类型**转换成合适的**`int`**类型**

---

#### **C 控制语句:循环**

---

> **章节概要**：再探`while`循环、`while`循环语句、迭代、关系运算符与关系表达式、真(true)与假(false)、`bool`布尔变量、`for`循环、`for`的几种使用示例、复合赋值运算符、出口条件循环`do-while`、循环嵌套、数组简介、函数返回值的使用

##### **再探 while 循环**

- **程序示例**

  ```c
  #include <stdio.h>
  int main(void)
  {
      long num;
      long sum = 0L;
      int status;
      printf("Please enter an integer to be summed");
      printf("(q to quit):");
      status = scanf("%ld", &num);
      while (status == 1)
      {
          sum = sum + num;
          printf("Please enter next integer (q to quit):");
          status = scanf("%ld", &num);
      }
      printf("Those integer sum to %ld.\n", sum);
      return 0;
  }
  ```

  - **新元素分析**

    - **sum**初始值为`0L`，为`long`类型的`0`，而非`int`类型的`0`
    - `==`为**相等运算符**，用于判断**前后值是否相等**，不要与`=`**赋值运算符**混淆
    - `scanf()`函数的**返回值**，返回**成功读取项的数量**，因此此处读取**1 个整数**，则**成功后**返回**1**

##### **while 循环语句**

- **while 循环语句格式**

  ```c
  while(关系表达式){
      循环体;
  }
  ```

- **迭代**:在循环的**关系表达式**为**假(0)**之前，循环的**判断和执行**一直**重复进行**，**每一次循环**都被称为一次**迭代**

- **循环条件**

  - 在**构建循环**时，必须让**测试表达式**的值**有变化**，表达式最终要为**假(0)**，否则循环就不会停止
  - 可以使用`while(1)`来构建简单的**死循环**，之后会将到如何**破除循环**
  - 注意**循环终止**的时间，只有**大括号内的语句**会**循环执行**，注意哪些语句需要循环执行，哪些不需要

##### **关系运算符与关系表达式**

- **关系运算符**

  > `==`：**相等运算符**，用于判断**前后值是否相等**，不要与`=`**赋值运算符**混淆  
  > `!=`：**不等运算符**，用于判断**前后值是否不相等**  
  > `<`：**小于运算符**，用于判断**前值是否小于后值**  
  > `>`：**大于运算符**，用于判断**前值是否大于后值**  
  > `<=`：**小于等于运算符**，用于判断**前值是否小于等于后值**  
  > `>=`：**大于等于运算符**，用于判断**前值是否大于等于后值**

- **真(true)与假(false)**

  > 1、**关系表达式**会产生**真(true)**和**假(false)**的值，**真(true)**值通过打印会得到为**1**，**假(false)**值通过打印会得到为**0**  
  > 2、因此`while`循环**判断**的实际为**表达式的真假值**  
  > 3、而在 C 语言中，一般所有**非 0 的值**都可以被识别为**真(true)**，只有**0**被识别为**假(false)**

- **\_Bool 布尔变量**

  > 1、**C99**新增了`_Bool`**布尔**类型变量，其只能储存**真(true)**和**假(false)**，所有其他非零数值都会被转换为**真(true)**  
  > 2、`stdbool.h`头文件让`bool`成为了`_Bool`的别名，还把**true**和**false**分别定义为**1**和**0**的**符号常量**  
  > 3、且使用该头文件的代码可以与`C++`**兼容**，因为`C++`把`bool`、`true`、`false`定义为**关键字**

##### **for 循环**

- **示例程序**

  ```c
  #include <stdio.h>
  int main(void)
  {
      const int NUMBER = 22;
      int count;
      for (count = 1; count <= NUMBER; count++)
      {
          printf("Be my Valentine\n");
      }
      return 0;
  }
  ```

- **for 循环格式**

  ```c
  for(初始化;测试条件;执行更新){
      循环体
  }
  ```

  > 1、`for`后面的括号中有**三个表达式**，分别用**两个分号**`;`隔开  
  > 2、**第 1 个**表达式是**初始化**，只会在`for`**循环开始时**执行**一次**  
  > 3、**第 2 个**表达式是**测试条件**，**测试条件**为**真(true)**时**执行**循环体**，**测试条件**为**假(false)**时**结束**循环**  
  > 4、**第 3 个**表达式是**执行更新**，**每次循环结束时求值**

- **for 的灵活性**

  - `for`循环十分灵活，可以利用**三个表达式**完成**几乎所有**需要的**条件判断**，使用`for`循环能更轻松清楚地完成**遍历**
  - **逗号运算符**`,`使得**循环头**可以包含**更多表达式**，如`for(i=0,a=10; i<a; i=i+2,a++)`
  - `for`循环的其他几种妙用

    ```c
    #include <stdio.h>
    int main(void)
    {
        //输出20内平方表
        printf("数字        平方\n");
        for (int i = 1; i <= 20; i++)
        {
            printf("%-11d %-11d\n", i, i * i);
        }
        return 0;
    }
    ```

    ```c
    #include <stdio.h>
    int main(void)
    {
        //输出ASCII码表
        printf("字符        ASCII码\n");
        for (char i = 'A'; i <= 'z'; i++)
        {
            printf("%-11c %-11d\n", i, i);
        }
        return 0;
    }
    ```

    ```c
    #include <stdio.h>
    int main(void)
    {
        //输出20内的、平方小于350的偶数
        //注: &&为“与”，表示两者皆满足；i+=2同i=i+2
        for (int i = 0; i <= 20 && i * i < 350; i += 2)
        {
            printf("%d\n", i);
        }
        return 0;
    }
    ```

##### **复合赋值运算符**

- **复合赋值运算符**:`+=`、`-=`、`*=`、`/=`、`%=`

- **符号赋值运算符**`+=`表示**加法赋值**，如`a+=2`意义等同于`a=a+2`，其余以此类推

##### **出口条件循环 do-while**

- 是`while`循环的一种**变种**，`while`为**入口处判断**，`do-while`为**出口处判断**
- 特点为**第一次执行**，无论如何`do-while`的**循环体至少执行一次**，出口处再**判断是否下次循环**。如下程序即使**count 初始值大于 22**，也会执行一次**do 内循环体**
- **示例程序**

  ```c
  #include <stdio.h>
  int main(void)
  {
      int count=1;
      do
      {
          printf("Be my Valentine\n");
          count++;
      } while (count < 22);
      return 0;
  }
  ```

##### **循环嵌套**

- **示例程序**

  ```c
  #include <stdio.h>
  int main(void)
  {
      //输出乘法表
      for (int i = 1; i <= 9; i++)
      {
          for (int j = 1; j <= i; j++)
          {
              printf("%d*%d=%-2d  ", j, i, i*j);
          }
          printf("\n");
      }
      return 0;
  }
  ```

- **循环嵌套**

  > 1、**循环嵌套**指在**循环内**包含**另一个循环**，执行顺序为**外层循环**过程中执行多次**内层循环**，两个循环的**大括号**分别**标识自己的循环体部分**  
  > 2、如上述示例程序**乘法表**，通过最内层`printf`能得知，使用**j**表示乘法表**第一个数字**，使用**i**表示**第二个数字**，使用**i\*j**表示**乘法的积**  
  > 3、通过`j<=i`的**循环条件**防止出现`2*3`后再次出现`3*2`**重复**  
  > 4、建议自己运行一次程序，感受循环的顺序，也可以改变几个数值，看看程序的变化

##### **数组简介**

- 在许多程序中，数组很重要。**数组**可以作为一种**储存多个相关元素**的**便利方式**，将在第十章详细介绍

- **数组**

  > 1、数组是**按顺序存储**的一系列**类型相同**的值，如 10 个`char`类型数值或 10 个`int`类型数值  
  > 2、整个数组有一个**数组名**，通过**整数下标**访问数组中**单独的项**或**元素**

- **数组声明与使用**

  > **数组声明**：示例`int a[15]`，表示声明一个**内涵 15 个元素**的整数数组  
  > **数组使用**：通过**下标**访问**指定元素**。数组的**第一个元素**为`a[0]`，**第二个元素**为`a[1]`，以此类推。实际上**数组元素**的使用与**同类型变量**相同  
  > **陷阱**：考虑到 C 执行速度，C 编译器**不会检查**数组**下标是否正常**，注意数组元素**不要超出定义的范围**  
  > **下标**：用于**标识数组元素的数字**叫做**下标**、**索引**或**偏移量**。下标**必须是整数**且要**从 0 开始计数**

- **for 循环中使用数组**

  - `for`**循环**的**数组使用**，可以通过利用**循环变量**的变化来**切换数组的元素**，示例如下：

    ```c
    #include <stdio.h>
    int main(void)
    {
        int a[10];
        //循环输入
        for (int i = 0; i < 10; i++)
        {
            scanf("%d", &a[i]);
        }
        //循环输出
        for (int i = 0; i < 10; i++)
        {
            printf("%-5d  ", a[i]);
        }
        return 0;
    }
    ```

##### **函数返回值的使用**

- 对于**有返回值的函数**，函数最后的`return`**语句**表示函数的**返回值**，即执行完函数后，函数**返回的值**

- **编写**一个有返回值的函数，需要注意以下几点：

  > 1、定义函数时，**确定函数的返回类型**  
  > 2、使用`return`表明待返回的值

- **示例程序**

  ```c
  #include <stdio.h>

  // double 函数名 表明函数返回一个double类型的值
  double power(double n, int p)
  {
      double pow = 1;
      for (int i = 1; i <= p; i++)
      {
          pow *= n;
      }
      // 返回pow的值
      return pow;
  }

  int main(void)
  {
      // a^b
      double a;
      int b;
      printf("输入底数:");
      scanf("%lf", &a);
      printf("输入指数:");
      scanf("%d", &b);
      // 调用函数
      printf("乘方结果:%lf", power(a, b));
      return 0;
  }
  ```

---

#### **C 控制语句:分支和跳转**

---

> **章节概要**：`if`语句、`if-else` 语句与 `else-if` 语句、`if` 与 `else` 的配对和嵌套 `if`、`getchar()`与`putchar()`函数、`ctype.h`系列的字符函数、逻辑运算符、备选拼写：`iso646.h`头文件、条件(三目)运算符、循环辅助：`continue`和`break`、`switch` 语句、`goto` 语句

##### **if 语句**

- **示例程序**

  ```c
  #include <stdio.h>
  int main(void)
  {
      int a, b;
      scanf("%d%d", &a, &b);
      if (a > b)
      {
          printf("Sure,A>B!\n");
      }
      printf("Over!");
      return 0;
  }
  ```

- **if 语句**

  > 1、`if`**语句**被称为**分支语句**或**选择语句**，因为它相当于一个**交叉点**，程序要在两条分支中**选择一条**执行  
  > 2、程序如果对**分支表达式**求值为**真**，则执行**执行语句**，否则**跳过**执行语句  
  > 3、`if`**语句**的通用形式如下

  ```c
  if (分支表达式){
      执行语句;
  }
  ```

##### **if-else 语句与 else-if 语句**

- **if-else 语句**

  > 1、简单的`if`**语句**可以让程序选择**执行一条语句或跳过**，而`if-else`**语句**可以在**两条语句之间做选择**  
  > 2、程序如果对**分支表达式**求值为**真**，则执行**执行语句 1**，否则执行**执行语句 2**  
  > 3、`if-else`**语句**的通用形式如下

  ```c
  if (分支表达式){
      执行语句1;
  }
  else{
      执行语句2;
  }
  ```

- **else-if 语句**

  > 1、`else-if`**语句**为**多重选择**语句，可以在**多个分支之间做选择**  
  > 2、程序会根据表达式是否为真**逐步判断**，特别注意，如果**第一个表达式为真**，则**不会继续向下执行**  
  > 3、`else-if`**语句**的通用形式如下

  ```c
  if (分支表达式1){
      执行语句1;
  }
  else if (分支表达式2){
      执行语句2;
  }
  else{
      执行语句3;
  }
  ```

##### **if 与 else 的配对和嵌套 if**

- 当一个程序有**多个**`if`和`else`，**如果没有花括号**，`else`将与**离它最近**的`if`配对，除非最近的 if 被花括号括起来  
  ![](https://s2.loli.net/2022/06/13/cyX9MLRs4nvfZ3x.png)

- 有关`if`的嵌套，与`for`的嵌套基本雷同，只需要注意**不同嵌套的花括号包括的范围**即可

##### **getchar()与 putchar()函数**

- **getchar()与 putchar()的使用**

  > 1、`getchar()`**函数**用于从**标准输入流**中**读取一个字符**，并将其存储在变量中  
  > 2、如把字符**储存进**变量**ch**，则写为`ch = getchar()`，其等效于`scanf("%c", &ch)`  
  > 3、`putchar()`**函数**用于**打印它的参数**  
  > 4、如打印**ch**的值，则写为`putchar(ch)`，其等效于`printf("%c",ch)`  
  > 5、由于这些函数**只处理字符**，所以比`scanf`与`printf`**更快更轻量**，而且**不需要转换说明**

- **探索如何工作的程序示例**

  ```c
  #include <stdio.h>
  int main(void)
  {
      char ch;
      ch = getchar();    // 读取第一个字符
      while (ch != '\n') // 当不为换行符时循环，即一行字符未结束时
      {
          if (ch == ' ') // 留下空格不变
          {
              putchar(ch);
          }
          else
          {
              putchar(ch + 1); //其他字符改变+1
          }
          ch = getchar(); //获取下一个字符
      }
      putchar(ch); //打印换行符
      return 0;
  }
  ```

  - 该程序**可以进行优化**，将**如下形式的循环**替换为**后者**

    ```c
    ch = getchar();
    while (ch != '\n'){
        ...
        ch = getchar();
    }
    ```

    ```c
    while ( (ch=getchar()) != '\n'){
        ...
    }
    ```

  - 这样的写法体现了**C 特有的编程风格**——**把两个行为合并成一个表达式**
  - 程序中的`putchar(ch+1);`语句，再次演示了**字符**实际上是**作为整数储存**的

##### **ctype.h 系列的字符函数**

- C 有一系列专门用于**处理字符**的**函数**，`ctype.h`**头文件**包含了这些**函数**的原型。这些函数**接受一个字符作为参数**，如果该字符**属于某特殊的类别**，则返回**true**，否则返回**false**

- `ctype.h`的**字符测试函数**

  |   函数名   | 如果是下列参数，返回值为 true                                          |
  | :--------: | ---------------------------------------------------------------------- |
  | isalnum()  | 字母或数字                                                             |
  | isalpha()  | 字母                                                                   |
  | isblank()  | 标准的空白字符(空格、换行、水平制表符)或其他本地指定为空白的字符       |
  | iscntrl()  | 控制字符，如`Ctrl+B`                                                   |
  | isdigit()  | 数字                                                                   |
  | isxdigit() | 十六进制数字符                                                         |
  | isgraph()  | 除空格以外的任意可打印字符                                             |
  | islower()  | 小写字母                                                               |
  | isupper()  | 大写字母                                                               |
  | isprint()  | 可打印字符                                                             |
  | ispunct()  | 标点符号(除空格和字母数字以外的任何可打印字符)                         |
  | isspace()  | 空白符(空格、换行、换页、回车、垂直或水平制表符、其他本地定义的空白符) |

- `ctype.h`的**字符映射函数**  

  |函数名|行为|
  |:---:|---|
  |tolower()|如果参数是大写字符，则函数返回小写，否则返回原始参数|
  |toupper()|如果参数是小写字符，则函数返回大写，否则返回原始参数|

##### **逻辑运算符**

- C 语言的`if`和`while`语句通常需要使用**关系表达式**作为测试条件。有时需要**多个关系表达式组合**，来判断**多个条件的逻辑关系**，**逻辑运算符**便可满足这一需求

- **3 种逻辑运算符**

  > 1、`&&`**逻辑与**：如果连接的两个表达式**都为 true**，则**返回 true**  
  > 2、`||`**逻辑或**：如果连接的两个表达式**至少有一个为 true**，则**返回 true**  
  > 3、`!`**逻辑非**：如果表达式为 **true**，则**返回 false**；如果表达式为 **false**，则**返回 true**

- **逻辑运算符优先级**

  > 1、`!`优先级**最高**、**`&&`**优先级**次之**、`||`优先级**最低**  
  > 2、`!`的优先级**仅次于圆括号**，比乘法运算符还高。`&&`、`||`的优先级都**比关系运算符低**，**比赋值运算符高**  
  > 3、因此，表达式`a>b && b>c || b>d`相当于`((a>b) && (b>c)) || (b>d)`

- **备选拼写：iso646.h 头文件**
  - 由于 C 使用**标准美式键盘**开发，部分键盘并**没有美式键盘的符号**。使用`iso646.h`**头文件**，可以使用`and`、`or`、`not`分别代替`&&`、`||`、`!`

##### **条件(三目)运算符**

- C 提供**条件(三目)运算符**作为表达`if-else`的一种便捷方式，常用于为一个变量**判断赋值或输出的值**时使用

- **三目运算符的使用**
  - **基本语法**：`测试条件 ? 结果true执行表达式 : 结果false执行表达式`
  - 例如`a = (num<0) ? -y : y;`等效于如下语句：
    ```c
    if (num < 0) {
        a = -y;
    } else {
        a = y;
    }
    ```
  - **三目运算符**也可以**嵌套使用**，使用**小括号表明不同层级部分**

##### **循环辅助：continue 和 break**

- **语句功能**

  > `continue`**语句**：在**循环过程**中，如果执行到`continue`语句，则会从`continue`执行处**跳过本层本次循环**的剩余内容，**继续执行下一次循环**  
  > `break`**语句**：在**循环过程**中，如果执行到`break`语句，则会从`break`执行处**终止本层循环**且**跳过未执行内容**，**不再进行下一次本层循环**

- **语句优势**
  > 1、可以**更加灵活**的控制循环的执行  
  > 2、能够**减少不必要的**`if-else`**层级缩进**，提高代码的**可读性**  
  > 3、使代码语句**结构更清晰紧凑**

##### **switch 语句**

- 使用**条件运算符**和`if-else`语句很容易编写**二选一**的程序，然而有时程序需要从**多个选项中选择**，尽管可以使用`else if`实现，但大多情况下`switch`**更加方便**

- **基本语法**

  ```c
  switch (表达式){
      case 表达式的可能值1:
          语句;
          break;
      case 表达式的可能值2:
          语句;
          break;
      ...
      default:
          语句;
          break;
  }
  ```

- **注意事项**

  > 1、`break`语句使程序离开`switch`语句，**直接执行**`switch`后的**下一条语句**，如果**没有**`break`，则会**按顺序**将**条件成立处**向后**所有**`case`内语句执行完毕，直到`default`语句后退出  
  > 2、C 语言的`case`一般都**指定一个值**，**不能使用一个范围**  
  > 3、关于`switch`不使用`break`会**向后执行**的特性，可以在特定的地方设定`break`，来利用这个特性，如下设计统计字母出现次数的程序

  ```c
  #include <stdio.h>
  int main(void)
  {
      char ch;                              // 输入字母
      int a_ct, b_ct, c_ct, d_ct, e_ct;     // 统计abcde的次数
      a_ct = b_ct = c_ct = d_ct = e_ct = 0; // 初始化为0
      printf("enter some text;enter # to quit");
      while ((ch = getchar()) != '#')
      {
          switch (ch)
          {
          case 'a': // 检测a时执行，并会向下执行'A'的语句
          case 'A': // 不论大写小写a，都会执行语句计入统计
              a_ct++;
              break; // break终止继续执行
          // 以此类推，此处省略bcde的case
          }
      }
      printf("A   B   C   D   E\n");
      printf("%-4d%-4d%-4d%-4d%-4d", a_ct, b_ct, c_ct, d_ct, e_ct);
      return 0;
  }
  ```

- **swith 与 if-else**

  > 1、通常而言，`switch`能干的`if-else`**都能实现**，但`switch`的运行**速度更快**  
  > 2、当需要判断**一个范围**或**浮点变量或表达式**时，`switch`**无法实现**  
  > 3、`switch`通常只是`if-else`的**优化**，对比之下，仍是`if-else`**泛用性更强**

##### **goto 语句**

- 早期版本的**BASIC**和**FORTRAN**所依赖的`goto`语句，在 C 中**仍然可用**，但**非常不建议**使用，即使没有`goto`语句 C 语言也仍能运行良好，且**逻辑更加清晰**

- **基本语法**

  ```c
  语句标签(如:part1):语句

  goto 语句标签;
  ```

---

#### **字符输入输出与输入验证**

---

> **章节概要**：单字符 I/O:`getchar`与`putchar`、缓冲区、完全缓冲 I/O 与行缓冲 I/O、结束键盘输入(C 处理文件的方式)、文件、流、检测文件结尾、C 语言的`EOF`、重定向和文件

##### **单字符 I/O:getchar 与 putchar**

- 在第七章中提到过，`getchar()`和`putchar()`每次**只处理一个字符**。可能这种方法过于笨拙，但这种方法**很适合计算机**。而且，这是绝大多数**文本处理程序**所用的**核心方法**

- 详细用法请参照**前一章**

- 为何输入的字符能直接**显示在屏幕**上？如果用一个**特殊字符**(如`#`)来**结束输入**，就无法**在文本中使用**这个字符。是否有**更好的办法**结束输入？首先要了解**C 程序如何处理键盘输入**，尤其是**缓冲**和**标准输入文件**的概念

##### **缓冲区**

- **缓冲输入与缓冲区**

  > **缓冲输入**：对于**程序输入**，大部分系统在用户按下`Enter`之前**不会重复打印**刚输入的字符，即在**重复输入字符**时，不会在终端出现`H(输入)H(输入后处理输出的字符)e(第二格输入的字符)elllloo`这样的情况。这种**输入形式**称为**缓冲输入**  
  > **缓冲区**：用户**输入的字符**会先被**收集并储存**在一个被称为**缓冲区**的**临时储存区**，按下`Enter`时，程序才可使用用户输入的字符

  ![](https://s2.loli.net/2022/06/15/gP38vdLms4abNn1.png)

- **为什么要有缓冲区**

  > 1、把**若干字符**作为**一个块**传输比**逐个发送**这些字符**节约时间**  
  > 2、如果用户**打错字符**，可以**直接通过键盘修正**，当最后按下`Enter`时，传输的是**正确的输入**  
  > 3、虽然缓冲输入**好处很多**，但某些**交互式程序**也需要**无缓冲输入**，比如在**游戏中**，希望**按下一个按键**就**立刻执行**相应的指令。因此缓冲输入和无缓冲输入**都有用武之地**

- **完全缓冲 I/O 与行缓冲 I/O**

  > **完全缓冲输入**：指当**缓冲区被填满**时才**刷新缓冲区**(内容被发送至目的地)，通常出现在**文件输入**中。**缓冲区大小**取决于**系统**，常见**512 字节**和**4096 字节**  
  > **行缓冲输入**：指在**出现换行**时**刷新缓冲区**。**键盘输入**通常是**行缓冲输入**，所以在按下`Enter`时才**刷新缓冲区**

- **使用缓冲输入还是无缓冲输入**

  > 1、**ANSI C**和**后续的 C 标准**都规定**输入是缓冲的**，不过最初 K&R 把这个**决定权**交给了**编译器的编写者**  
  > 2、**ANSI C**决定把**缓冲输入**作为**标准输入**的原因是：一些计算机**不允许无缓冲输入**  
  > 3、**ANSI C**没有提供**调用无缓冲输入**的**标准方式**，这意味着能否进行无缓冲输入**取决于计算机系统**

##### **结束键盘输入(C 处理文件的方式)**

- **文件、流和键盘输入**

  - **文件**

    > 1、**文件**是**储存器**中**储存信息的区域**。通常，文件都**保存**在某种**永久储存器**中(如硬盘、U 盘、DVD 等)。  
    > 2、毫无疑问，文件对于计算机系统**相当重要**。例如你编写的**C 程序**就保存在**文件**中，用来**编译 C 程序**的**程序**也保存在**文件**中  
    > 3、某些程序需要**访问指定的文件**。当**编译**储存在名为`echo.c`**文件**中的**程序**时，编译器**打开**`echo.c`文件并**读取**其中的内容，当编译器**处理完后**，会**关闭**该文件  
    > 4、其他程序，例如**文字处理器**，不仅要**打开**、**读取**、**关闭**文件，还要把数据**写入**文件

  - **C 语言与文件**

    > 1、C 是一门强大、灵活的语言，有许多用于**打开**、**读取**、**写入**、**关闭**文件的**库函数**  
    > 2、从**较低层面**上，C 可以使用**主机操作系统**的**基本文件工具**直接处理文件，这些直接**调用操作系统**的**函数**被称为**底层 I/O**。但计算机系统**各不相同**，所以**不可能**为普通的**底层 I/O**函数创建**标准库**  
    > 3、从**较高层面**上，C 还可以通过**标准 I/O 包**来处理文件。这涉及**创建**用于处理文件的**标准模型**和一套**标准 I/O 函数**。这一层面上，具体的**C 实现**负责**处理不同系统的差异**，以便用户使用**统一**的界面

  - **流(stream)**

    > 1、从**概念上**看，C 程序**处理**的是**流**，而**不是直接处理文件**  
    > 2、**流**是一个**实际输入或输出**映射的**理想化数据流**。这意味着**不同属性**和**不同种类**的输入，由**属性更统一**的**流**来表示  
    > 3、于是，**打开文件的过程**就是把**流**与**文件**关联，而且**读写**都通过**流**来完成

- **文件结尾**

  - **操作系统检测文件结尾**

    > 1、计算机**操作系统**要以某种方式**判断文件的开始和结束**，其中**一种方法**是，在**文件末尾**放一个**特殊的字符**标记文件结尾  
    > 2、**CP/M**，**IBM-DOS**，**MS-DOS**的文本文件曾经都**用过这种方法**。如今这些操作系统可以使用**内嵌的**`Ctrl+Z`字符来标记文件结尾  
    > 3、这**曾经是**操作系统使用的**唯一标记**，不过现在有一些**其他选择**，如**记录文件的大小**。所以现代的文本文件**不一定有**嵌入的`Ctrl+Z`，但如果有，**操作系统**会**将其视为**一个**文件结尾的标记**，如后附图  
    > 4、操作系统使用的**另一种方法**是**储存文件大小的信息**。如果文件有**3000 字节**，那么**读到 3000 字节**时便**达到文件的末尾**  
    > 5、**MS-DOS**及其相关系统使用这种方法**处理二进制文件**，因为用这种方法可以在文件中**储存所有的字符**。新版的**DOS**也使用这种方式**处理文本文件**。**UNIX**使用这种方式**处理所有的文件**

    ![](https://s2.loli.net/2022/06/16/ANt5CdYcEu94Og1.png)

  - **C 语言检测文件结尾**

    > 1、在 C 语言中，用`getchar()`读取文件**检测到文件结尾**时，会返回**特殊值**`EOF`(End Of Line 缩写)。`scanf()`检测到文件结尾时也返回`EOF`  
    > 2、通常，`EOF`被定义在`stdio.h`**文件中**：`#define EOF (-1)`

  - **关于 EOF**

    > 1、为什么是**选用-1**？因为`getchar()`函数的**返回值**介于**0~127**，这些值对应**标准字符集**。但是如果系统能识别**拓展字符集**，则**返回值**可能在**0~255**。但无论哪种情况，**-1 都不对应任何字符**，所以选用-1 标记文章结尾  
    > 2、某些系统也许把`EOF`**定义为-1 以外的值**，但是**定义的值**一定与**输入字符**所产生的**返回值**会**不同**。如果包含`stdio.h`文件，并使用`EOF`符号，就**不必担心**值不同的问题。这里关键要理解`EOF`**是一个值**，标志着**检测到文件结尾**，**并不是**在文件中**找得到的符号**  
    > 3、如何在**程序中使用**？把`getchar()`的**返回值**和`EOF`比较，如果**不同**则**没有到达文件结尾**，即如下：`while((ch = getchar()) != EOF)`

  - **键盘模拟文件结尾条件**

    - 如果**正在读取**的是**键盘输入**而**不是文件**会怎样？绝大部分系统都有办法**通过键盘模拟文件结尾条件**。如下示例：

      ```c
      #include <stdio.h>
      int main(void)
      {
          int ch;
          while ((ch = getchar()) != EOF)
          {
              putchar(ch);
          }
          return 0;
      }
      ```

    > 1、不用定义`EOF`，因为`stdio.h`已经**定义过了**  
    > 2、不用担心`EOF`的**实际值**，因为`EOF`在`stdio.h`中用`#define`预处理指令定义，**可直接使用**  
    > 3、变量**ch**的类型从`char`变成了`int`，因为`char`的变量只能表示**0~255**的**无符号**整数，但`EOF`的**值是-1**。还好`getchar()`函数**实际返回值类型**是`int`，所以它可以读取`EOF`字符。如果实现使用**有符号**的`char`类型，也可以把**ch**声明为`char`，但最好还是用**更通用**的形式  
    > 4、由于`getchar()`**返回类型**是`int`，如果把`getchar()`的**返回值**赋给`char`变量，一些编译器可能会**警告甚至丢失数据**  
    > 5、**ch**是**整数**不会影响`putchar()`，该函数仍然会**打印等价字符**  
    > 6、使用该程序进行**键盘输入**，要设法输入`EOF`字符，不能只输入**字符 EOF**，也不能只输入**数值-1**(会被当做一个连字符和一个数字 1)。正确的方法是**找出当前系统的要求**，如大多数**UNIX**和**Linux**系统中在**一行开始**使用`Ctrl+Z`会**传输文件结尾信号**，而**Windows**系统中在**一行开始**使用`Ctrl+Z`会**传输文件结尾信号**，所以在程序中需要**设立不同的提示语**提醒用户

##### **重定向和文件**

- 码字中。。。

---

#### **页底评论**

---
